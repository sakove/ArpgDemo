# 龙血契约 (Dragon Blood Contract)

## 项目架构

本项目采用基于组件和状态机的架构，以实现高度可扩展和可维护的2D横版动作游戏。

### 核心系统

1. **状态机系统**
   - `PlayerStateMachine`: 管理玩家的各种状态和状态转换
   - `PlayerState`: 所有具体状态的基类
   - 具体状态: `IdleState`, `MovingState`, `JumpingState`, `FallingState`, `AttackingState`, `DashingState`等

2. **技能系统**
   - `Skill`: 技能基类，使用ScriptableObject实现可配置的技能
   - `BasicAttackSkill`: 基础攻击技能
   - 可扩展为各种特殊技能

3. **战斗系统**
   - `CombatController`: 处理玩家的战斗相关逻辑
   - `IDamageable`: 可受伤害接口，所有可受伤的实体都实现此接口

4. **效果系统**
   - `TimeManager`: 控制游戏时间，实现命中停顿等效果
   - `CameraShake`: 相机震动效果，增强游戏反馈

### 文件夹结构

- `StateMachine/`: 状态机相关脚本
  - `States/`: 具体状态类
- `Skills/`: 技能相关脚本
- `Combat/`: 战斗系统相关脚本
- `Effects/`: 游戏效果相关脚本
- `Player/`: 玩家相关脚本
- `Enemies/`: 敌人相关脚本
- `Managers/`: 游戏管理器
- `UI/`: 用户界面
- `Utils/`: 工具类

## 游戏手感优化

为了实现优秀的游戏手感，本项目实现了以下机制：

1. **输入缓冲**
   - 跳跃缓冲：允许玩家在落地前按下跳跃键，并在落地后立即跳跃
   - 攻击缓冲：允许玩家在攻击动画结束前输入下一次攻击，实现连击

2. **土狼时间(Coyote Time)**
   - 允许玩家在离开平台后短时间内仍能跳跃，使跳跃感觉更加宽容

3. **命中停顿(Hit Stop)**
   - 攻击命中时短暂暂停游戏时间，增强打击感

4. **相机震动**
   - 在关键动作和受击时添加相机震动，增强视觉反馈

5. **可中断动作**
   - 大部分动作可以被其他高优先级动作中断，提高操作流畅度

## 开发指南

### 添加新状态

1. 创建一个继承自`PlayerState`的新类
2. 实现必要的方法：`Enter()`, `Exit()`, `LogicUpdate()`, `PhysicsUpdate()`
3. 在`PlayerStateMachine`中添加对新状态的引用
4. 实现状态转换逻辑

### 添加新技能

1. 创建一个继承自`Skill`的新类
2. 使用Unity编辑器创建技能资产
3. 配置技能参数
4. 将技能分配给玩家或敌人

### 添加新敌人

1. 创建一个继承自`EnemyBase`的新类
2. 实现敌人的AI和战斗逻辑
3. 配置敌人的属性和行为

## 输入系统

本项目使用Unity新输入系统(Input System)，主要操作如下：

- 移动：WASD或方向键
- 跳跃：空格键
- 攻击：鼠标左键或J键
- 冲刺：左Shift或K键
- 技能1-3：1-3键或Q/E/R键

## 注意事项

- 所有可配置参数应使用SerializeField公开给编辑器，而不是硬编码
- 使用接口和抽象类实现松耦合
- 遵循单一责任原则，每个类只负责一个功能
- 使用事件系统进行组件间通信，避免直接引用 